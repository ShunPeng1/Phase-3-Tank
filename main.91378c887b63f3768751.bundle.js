(()=>{"use strict";var e,t={248:(e,t,s)=>{var i=s(440);class n extends Phaser.Scene{constructor(){super({key:"BootScene"})}preload(){this.cameras.main.setBackgroundColor(0),this.createLoadingGraphics(),this.load.on("progress",(e=>{this.progressBar.clear(),this.progressBar.fillStyle(8971347,1),this.progressBar.fillRect(this.cameras.main.width/4,this.cameras.main.height/2-16,this.cameras.main.width/2*e,16)}),this),this.load.on("complete",(()=>{this.progressBar.destroy(),this.loadingBar.destroy()}),this),this.load.pack("preload","./assets/pack.json","preload");const e=new i.GameObjects.Graphics(this,{fillStyle:{color:0}});e.fillRect(0,0,this.scale.width,this.scale.height),e.generateTexture("black",this.scale.width,this.scale.height)}create(){this.anims.create({key:"explosion",frames:[{key:"explosion-01"},{key:"explosion-02"},{key:"explosion-03"},{key:"explosion-04"},{key:"explosion-05"},{key:"explosion-06"},{key:"explosion-07"},{key:"explosion-08"}],frameRate:12,repeat:0}),this.anims.create({key:"flash-a",frames:[{key:"flash-a-01"},{key:"flash-a-02"},{key:"flash-a-03"}],frameRate:12,repeat:0})}update(){this.scene.start("MenuScene")}createLoadingGraphics(){this.loadingBar=this.add.graphics(),this.loadingBar.fillStyle(16777215,1),this.loadingBar.fillRect(this.cameras.main.width/4-2,this.cameras.main.height/2-18,this.cameras.main.width/2+4,20),this.progressBar=this.add.graphics()}}const a=n;class o{constructor(e){this.sounds=[],this.listenerPosition=new Phaser.Math.Vector2(0,0),this.listenerRange=100,this.scene=e,this.scene.data.set("audioController",this),o.musicConfig||(o.musicConfig={loop:!0,volume:1}),o.soundConfig||(o.soundConfig={volume:1}),this.scene.events.on("shutdown",(()=>{this.scene.data.get("audioController").stopAll()})),this.scene.events.on("destroy",(()=>{this.scene.data.get("audioController").stopAll()}))}adjustMusicVolume(e){o.musicConfig.volume=e,this.music&&this.music.isPlaying&&this.music.setVolume(e)}setListenerAttributes(e,t){this.listenerPosition=e,this.listenerRange=t}adjustSoundVolume(e){o.soundConfig.volume=e,this.sounds.forEach((t=>{t.isPlaying&&t.setVolume(e)}))}getMusicVolume(){return o.musicConfig&&o.musicConfig.volume?o.musicConfig.volume:0}getSoundVolume(){return o.soundConfig&&o.soundConfig.volume?o.soundConfig.volume:0}playSound(e,t=!1,s=this.listenerPosition){var i;const n=this.scene.sound.add(e,o.soundConfig);if(t&&s){const e=Phaser.Math.Distance.BetweenPoints(this.listenerPosition,s),t=Math.max(0,1-e/this.listenerRange)*((null===(i=o.soundConfig)||void 0===i?void 0:i.volume)||0);n.setVolume(t)}n.play(),this.sounds.push(n),n.on("complete",(()=>{const e=this.sounds.indexOf(n);-1!==e&&this.sounds.splice(e,1)}))}stopSound(e){const t=this.sounds.findIndex((t=>t.key===e));-1!==t&&(this.sounds[t].stop(),this.sounds.splice(t,1))}playMusic(e){this.music&&this.music.isPlaying&&this.music.stop(),this.music=this.scene.sound.add(e,o.musicConfig),this.music.play()}stopAll(){this.music&&this.music.isPlaying&&this.music.stop(),this.sounds.forEach((e=>{e.isPlaying&&e.stop()})),this.sounds=[]}}o.AUDIO_CONTROLLER_KEY="audioController";const h=o;class r extends Phaser.GameObjects.Image{constructor(e){super(e.scene,e.x,e.y,e.texture),this.isDestoyed=!1,this.rotation=e.rotation,this.initImage(),this.scene.add.existing(this),this.audioController=this.scene.data.get(h.AUDIO_CONTROLLER_KEY);let t=["gun-1-1","gun-1-2","gun-1-3","gun-1-4","gun-1-5"];this.audioController.playSound(t[Math.floor(Math.random()*t.length)],!0,new Phaser.Math.Vector2(this.x,this.y))}pause(){this.originalVelocity=new Phaser.Math.Vector2(this.body.velocity.x,this.body.velocity.y),this.body.setVelocity(0,0),this.explosionSprite&&this.explosionSprite.anims.pause()}resume(){this.originalVelocity&&this.body.setVelocity(this.originalVelocity.x,this.originalVelocity.y),this.explosionSprite&&this.explosionSprite.anims.isPaused&&this.explosionSprite.anims.resume()}initImage(){this.bulletSpeed=1e3,this.setOrigin(.5,.5),this.setDepth(.5),this.scene.physics.world.enable(this),this.scene.physics.velocityFromRotation(this.rotation-Math.PI/2,this.bulletSpeed,this.body.velocity)}explode(){if(this.isDestoyed)return;this.isDestoyed=!0,this.explosionSprite=this.scene.add.sprite(this.x,this.y,"explosion-01").play("explosion"),this.explosionSprite.setScale(.5),this.explosionSprite.on("animationcomplete",(()=>{var e;null===(e=this.explosionSprite)||void 0===e||e.destroy(),this.explosionSprite=null,this.destroy()})),this.setVisible(!1),this.body.enable=!1;let e=["small-explosion-01","small-explosion-02","small-explosion-03","small-explosion-04","small-explosion-05","small-explosion-06","small-explosion-07","small-explosion-08","small-explosion-09","small-explosion-10","small-explosion-11","small-explosion-12","small-explosion-13","small-explosion-14","small-explosion-15"];this.audioController.playSound(e[Math.floor(Math.random()*e.length)],!0,new Phaser.Math.Vector2(this.x,this.y))}}const l=r;class c extends Phaser.Events.EventEmitter{constructor(e){super(),this.maxEnemies=0,this.enemies=e}addEnemy(e){this.enemies.push(e),this.maxEnemies=Math.max(this.maxEnemies,this.enemies.length)}destroyEnemy(e){this.enemies=this.enemies.filter((t=>t!==e)),e.destroy(),this.emit(c.ENEMY_DESTROYED_EVENT,this.enemies,this.maxEnemies)}getEnemies(){return this.enemies}}c.ENEMY_DESTROYED_EVENT="enemyDestroyed",c.ENEMY_COUNTER_KEY="enemyCounter",c.PLAYER_DIED_EVENT="playerDied";const d=c;class u extends Phaser.GameObjects.GameObject{constructor(e,t,s,i,n,a=1e3){super(e,"tireTrack"),this.follow=i,this.emitter=new Phaser.GameObjects.Particles.ParticleEmitter(e,t,s,"tireTrack",{lifespan:a,alpha:{start:1,end:0},follow:i,frequency:n}),this.emitter.onParticleEmit((e=>{e.angle=Phaser.Math.RadToDeg(i.rotation)})),this.scene.add.existing(this.emitter)}setDepth(e){this.emitter.setDepth(e)}start(){this.emitter.start()}stop(){this.emitter.stop()}destroy(e){this.emitter.stop();let t=()=>{0===this.emitter.getAliveParticleCount()?(super.destroy(e),this.emitter.destroy()):this.scene.time.delayedCall(100,t)};t()}}const E=u;class T extends Phaser.GameObjects.Image{getBullets(){return this.bullets}constructor(e){super(e.scene,e.x,e.y,e.texture,e.frame),this.isPaused=!1,this.listeningRange=1200,this.handleBarrelRotation=e=>{if(!this.active)return;const t=e.positionToCamera(this.scene.cameras.main);this.barrel.rotation=Phaser.Math.Angle.Between(this.barrel.x,this.barrel.y,t.x,t.y)+Math.PI/2},this.audioController=this.scene.data.get(h.AUDIO_CONTROLLER_KEY),this.initImage(),this.scene.add.existing(this)}pause(){this.body.setVelocity(0,0),this.scene.input.keyboard.disableGlobalCapture(),this.scene.input.off("pointermove",this.handleBarrelRotation),this.scene.input.off("pointerdown",this.handleShooting),this.isPaused=!0}resume(){this.scene.input.keyboard.enableGlobalCapture(),this.scene.input.on("pointermove",this.handleBarrelRotation,this),this.scene.input.on("pointerdown",this.handleShooting,this),this.isPaused=!1}initImage(){this.health=1,this.lastShoot=0,this.speed=300,this.angularSpeed=.03,this.setOrigin(.5,.5),this.setDepth(0),this.angle=180,this.barrel=this.scene.add.image(this.x,this.y,"barrelBlue"),this.barrel.setOrigin(.5,1),this.barrel.setDepth(1),this.barrel.angle=180,this.lifeBar=this.scene.add.graphics(),this.redrawLifebar(),this.bullets=this.scene.add.group({active:!0,maxSize:10,runChildUpdate:!0}),this.cursors=this.scene.input.keyboard.createCursorKeys(),this.wasdKeys={up:this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.W),down:this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.S),left:this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A),right:this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.D)},this.scene.input.on("pointermove",this.handleBarrelRotation,this),this.scene.input.on("pointerdown",this.handleShooting,this),this.movementIndicator=this.scene.add.image(0,-50,"lineArrow"),this.movementIndicator.setOrigin(0,.5),this.movementIndicator.setScale(.03),this.movementIndicator.setDepth(0),this.movementIndicator.setRotation(-Math.PI/2),this.movementIndicator.setAlpha(.8),this.tireTracks=new E(this.scene,0,0,this,80),this.tankContainer=this.scene.add.container(this.x,this.y,[this.movementIndicator]),this.scene.physics.world.enable(this)}update(){this.isPaused||(this.active?(this.barrel.x=this.x,this.barrel.y=this.y,this.lifeBar.x=this.x,this.lifeBar.y=this.y,this.handleInput()):this.destroy())}destroy(){this.barrel.destroy(),this.lifeBar.destroy(),this.tireTracks.destroy(),super.destroy()}handleInput(){this.cursors.up.isDown||this.wasdKeys.up.isDown?this.scene.physics.velocityFromRotation(this.rotation-Math.PI/2,this.speed,this.body.velocity):this.cursors.down.isDown||this.wasdKeys.down.isDown?this.scene.physics.velocityFromRotation(this.rotation-Math.PI/2,-this.speed,this.body.velocity):this.body.setVelocity(0,0),this.cursors.left.isDown||this.wasdKeys.left.isDown?this.rotation-=this.angularSpeed:(this.cursors.right.isDown||this.wasdKeys.right.isDown)&&(this.rotation+=this.angularSpeed),this.tankContainer.setPosition(this.x,this.y),this.tankContainer.setRotation(this.rotation),this.audioController.setListenerAttributes(new Phaser.Math.Vector2(this.x,this.y),this.listeningRange)}handleShooting(e){if(this.active&&e.leftButtonDown()&&this.scene.time.now>this.lastShoot){this.scene.cameras.main.shake(20,.005),this.scene.tweens.add({targets:this,props:{alpha:.8},delay:0,duration:5,ease:"Power1",easeParams:null,hold:0,repeat:0,repeatDelay:0,yoyo:!0,paused:!1});let e=this.barrel.x+58*Math.sin(this.barrel.rotation),t=this.barrel.y-58*Math.cos(this.barrel.rotation);this.bullets.getLength()<10&&(this.bullets.add(new l({scene:this.scene,rotation:this.barrel.rotation,x:e,y:t,texture:"bulletBlue"})),this.lastShoot=this.scene.time.now+80)}}redrawLifebar(){this.lifeBar.clear(),this.lifeBar.fillStyle(15100456,1),this.lifeBar.fillRect(-this.width/2,this.height/2,this.width*this.health,15),this.lifeBar.lineStyle(2,16777215),this.lifeBar.strokeRect(-this.width/2,this.height/2,this.width,15),this.lifeBar.setDepth(1)}updateHealth(){this.health>0?(this.health-=.025,this.redrawLifebar()):(this.health=0,this.active=!1,this.scene.data.get(d.ENEMY_COUNTER_KEY).emit(d.PLAYER_DIED_EVENT))}}const p=T;class y{constructor(){this.inventory={},this.subscribers={},this.loadInventory()}static getInstance(){return y.instance||(y.instance=new y),y.instance}addItem(e,t){if(this.inventory[e]){let s=this.inventory[e];this.inventory[e]=(parseInt(this.inventory[e])+t).toString(),this.notifySubscribers(e,s)}else{let s="0";this.inventory[e]=t.toString(),this.notifySubscribers(e,s)}}removeItem(e){if(this.inventory[e]){let t=this.inventory[e];delete this.inventory[e],this.notifySubscribers(e,t),this.saveInventory()}}setItem(e,t){if(this.inventory[e]){let s=this.inventory[e];this.inventory[e]=t,this.notifySubscribers(e,s)}else{let s="";this.inventory[e]=t,this.notifySubscribers(e,s)}this.saveInventory()}getItemAsNumber(e){return parseInt(this.inventory[e])}getItem(e){return this.inventory[e]}getInventory(){return this.inventory}subscribe(e,t){this.subscribers[e]||(this.subscribers[e]=[]),this.subscribers[e].push(t)}unsubscribe(e,t){if(this.subscribers[e]){const s=this.subscribers[e].indexOf(t);-1!==s&&this.subscribers[e].splice(s,1)}}notifySubscribers(e,t){if(this.subscribers[e]){const s=this.inventory[e]||"";this.subscribers[e].forEach((e=>e(t,s)))}}saveInventory(){localStorage.setItem("inventory",JSON.stringify(this.inventory))}loadInventory(){const e=localStorage.getItem("inventory");e&&(this.inventory=JSON.parse(e))}}const _=y;class g extends Phaser.Events.EventEmitter{constructor(){super(),this.score=0,this.highScore=0}addScore(e){this.score+=e,this.emit(g.SCORE_CHANGE_EVENT,this.score-e,this.score)}getScore(){return this.score}resetScore(){this.score=0,this.emit(g.SCORE_CHANGE_EVENT,this.score,0)}setScore(e){this.score=e,this.emit(g.SCORE_CHANGE_EVENT,this.score,e)}saveHighScore(){this.score>this.highScore&&(this.highScore=this.score,_.getInstance().setItem("highScore",this.highScore.toString()),this.emit(g.HIGH_SCORE_CHANGE_EVENT,this.highScore))}loadHighScore(){const e=_.getInstance().getItem("highScore");return this.highScore=e?parseInt(e):0,this.emit(g.HIGH_SCORE_CHANGE_EVENT,this.highScore),this.highScore}resetHighScore(){this.highScore=0,_.getInstance().removeItem("highScore"),this.emit(g.HIGH_SCORE_CHANGE_EVENT,this.highScore)}}g.SCORE_CHANGE_EVENT="scoreChange",g.SCORE_COUNTER_KEY="scoreCounter",g.HIGH_SCORE_CHANGE_EVENT="highScoreChange";const m=g;class N extends Phaser.GameObjects.Image{getBarrel(){return this.barrel}getBullets(){return this.bullets}constructor(e){super(e.scene,e.x,e.y,e.texture,e.frame),this.originalVelocity=new Phaser.Math.Vector2(0,0),this.isPaused=!1,this.initContainer(),this.scene.add.existing(this)}pause(){this.isPaused||(this.originalVelocity.x=this.body.velocity.x,this.originalVelocity.y=this.body.velocity.y,this.body.setVelocity(0,0),this.moveTween.pause(),this.isPaused=!0)}resume(){this.isPaused&&(this.body.setVelocity(this.originalVelocity.x,this.originalVelocity.y),this.moveTween.resume(),this.isPaused=!1)}initContainer(){this.health=1,this.lastShoot=0,this.speed=100,this.setDepth(0),this.barrel=this.scene.add.image(0,0,"barrelRed"),this.barrel.setOrigin(.5,1),this.barrel.setDepth(1),this.lifeBar=this.scene.add.graphics(),this.redrawLifebar(),this.bullets=this.scene.add.group({active:!0,maxSize:10,runChildUpdate:!0}),this.moveTween=this.scene.tweens.add({targets:this,props:{y:this.y-200},delay:0,duration:2e3,ease:"Linear",easeParams:null,hold:0,repeat:-1,repeatDelay:0,yoyo:!0}),this.tireTracks=new E(this.scene,0,0,this,200,1500),this.scene.physics.world.enable(this)}update(){this.isPaused||(this.active?(this.barrel.x=this.x,this.barrel.y=this.y,this.lifeBar.x=this.x,this.lifeBar.y=this.y,this.handleShooting()):this.destroy())}destroy(e){this.barrel.destroy(),this.lifeBar.destroy(),this.tireTracks.destroy(),super.destroy(e)}handleShooting(){this.scene.time.now>this.lastShoot&&this.bullets.getLength()<10&&(this.bullets.add(new l({scene:this.scene,rotation:this.barrel.rotation,x:this.barrel.x,y:this.barrel.y,texture:"bulletRed"})),this.lastShoot=this.scene.time.now+400)}redrawLifebar(){this.lifeBar.clear(),this.lifeBar.fillStyle(15100456,1),this.lifeBar.fillRect(-this.width/2,this.height/2,this.width*this.health,15),this.lifeBar.lineStyle(2,16777215),this.lifeBar.strokeRect(-this.width/2,this.height/2,this.width,15),this.lifeBar.setDepth(1)}updateHealth(){this.scene.data.get(m.SCORE_COUNTER_KEY).addScore(10),this.health>0?(this.health-=.15,this.redrawLifebar()):(this.health=0,this.active=!1,this.scene.data.get(d.ENEMY_COUNTER_KEY).destroyEnemy(this))}}const S=N;class f extends Phaser.GameObjects.Image{constructor(e){super(e.scene,e.x,e.y,e.texture),this.initImage(),this.scene.add.existing(this)}initImage(){this.setOrigin(0,0),this.scene.physics.world.enable(this),this.body.setImmovable(!0)}update(){}}const U=f,b=class{constructor(e,t){this.objects=[],this.scene=e,this.objects=t}setObjectFromScene(e){const t=e.sys.updateList.getActive().filter((e=>"pause"in e&&"function"==typeof e.pause&&"resume"in e&&"function"==typeof e.resume)),s=e.sys.displayList.list.filter((e=>"pause"in e&&"function"==typeof e.pause&&"resume"in e&&"function"==typeof e.resume));this.objects=[...t,...s]}pause(){this.objects.forEach((e=>{e.pause()}))}resume(){this.objects.forEach((e=>{e.resume()}))}},O=class{static applyPositionTweens(e,t,s,i=e.x,n=e.y,a=10,o=10,h=100){let r,l=!1,c=null,d=null;const u=()=>{d&&d.complete(),r=new Phaser.Math.Vector2(i,n);const t=r.x+a,s=r.y+o;l=!0,c=e.scene.tweens.add({targets:e,x:t,y:s,duration:h,ease:"Linear",onComplete:()=>{e.setPosition(t,s),c=null}})},E=()=>{l&&(c&&c.stop(),l=!1,d=e.scene.tweens.add({targets:e,x:r.x,y:r.y,duration:h,ease:"Linear",onComplete:()=>{e.setPosition(r.x,r.y),d=null}}))};"string"==typeof t&&(t=[t]),t.forEach((t=>{e.on(t,u)})),"string"==typeof s&&(s=[s]),s.forEach((t=>{e.on(t,E)}))}static applyScaleTweens(e,t,s,i=e.scaleX,n=e.scaleY,a=.95,o=100){let h,r=!1,l=null,c=null;const d=()=>{c&&c.complete(),h=new Phaser.Math.Vector2(i,n);const t=h.x*a,s=h.y*a;r=!0,l=e.scene.tweens.add({targets:e,scaleX:t,scaleY:s,duration:o,ease:"Linear",onComplete:()=>{e.setScale(t,s),l=null}})},u=()=>{r&&(l&&l.stop(),r=!1,c=e.scene.tweens.add({targets:e,scaleX:h.x,scaleY:h.y,duration:o,ease:"Linear",onComplete:()=>{e.setScale(h.x,h.y),c=null}}))};"string"==typeof t&&(t=[t]),t.forEach((t=>{e.on(t,d)})),"string"==typeof s&&(s=[s]),s.forEach((t=>{e.on(t,u)}))}static applyDisplaySizeTweens(e,t,s,i=e.displayWidth,n=e.displayHeight,a=.95,o=100){let h,r=!1,l=null,c=null;const d=()=>{c&&c.complete(),h=new Phaser.Math.Vector2(i,n);const t=h.x*a,s=h.y*a;r=!0,l=e.scene.tweens.add({targets:e,displayWidth:t,displayHeight:s,duration:o,ease:"Linear",onComplete:()=>{e.setDisplaySize(t,s),l=null}})},u=()=>{r&&(l&&l.stop(),r=!1,c=e.scene.tweens.add({targets:e,displayWidth:h.x,displayHeight:h.y,duration:o,ease:"Linear",onComplete:()=>{e.setDisplaySize(h.x,h.y),c=null}}))};"string"==typeof t&&(t=[t]),t.forEach((t=>{e.on(t,d)})),"string"==typeof s&&(s=[s]),s.forEach((t=>{e.on(t,u)}))}static applyTintTweens(e,t,s,i=16777215,n=0,a=100){let o=!1,h=null,r=null;const l=()=>{r&&r.complete(),o=!0,h=e.scene.tweens.add({targets:e,tint:{from:i,to:n},duration:a,ease:"Linear",onUpdate:t=>{let s=Phaser.Display.Color.Interpolate.ColorWithColor(Phaser.Display.Color.ValueToColor(i),Phaser.Display.Color.ValueToColor(n),100,100*t.progress);e.setTint(s.r<<16|s.g<<8|s.b)},onComplete:()=>{e.setTint(n),h=null},onStop:()=>{e.setTint(n),h=null}})},c=()=>{o&&(h&&h.stop(),o=!1,r=e.scene.tweens.add({targets:e,tint:{from:n,to:i},duration:a,ease:"Linear",onUpdate:t=>{let s=Phaser.Display.Color.Interpolate.ColorWithColor(Phaser.Display.Color.ValueToColor(n),Phaser.Display.Color.ValueToColor(i),100,100*t.progress);e.setTint(s.r<<16|s.g<<8|s.b)},onComplete:()=>{e.setTint(i),r=null}}))};"string"==typeof t&&(t=[t]),t.forEach((t=>{e.on(t,l)})),"string"==typeof s&&(s=[s]),s.forEach((t=>{e.on(t,c)}))}static applyAlphaTweens(e,t,s,i=1,n=0,a=100){let o=!1,h=null,r=null;const l=()=>{r&&r.complete(),o=!0,h=e.scene.tweens.add({targets:e,alpha:{from:i,to:n},duration:a,ease:"Linear",onUpdate:()=>{e.setAlpha(e.alpha)},onComplete:()=>{e.setAlpha(n),h=null}})},c=()=>{o&&(h&&h.stop(),o=!1,r=e.scene.tweens.add({targets:e,alpha:{from:n,to:i},duration:a,ease:"Linear",onUpdate:()=>{e.setAlpha(e.alpha)},onComplete:()=>{e.setAlpha(i),r=null}}))};"string"==typeof t&&(t=[t]),t.forEach((t=>{e.on(t,l)})),"string"==typeof s&&(s=[s]),s.forEach((t=>{e.on(t,c)}))}};class w extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t,s),this.scene.add.existing(this),this.setScrollFactor(0,0),this.hitArea=new Phaser.GameObjects.Zone(e,0,0,0,0),this.hitArea.setScrollFactor(0,0),this.add(this.hitArea)}add(e,t="Center",s=0,i=0){if(Array.isArray(e))return e.forEach((e=>{this.add(e,t,s,i)})),this;switch(t){case"TopLeft":Phaser.Display.Align.In.TopLeft(e,this.hitArea,s,i);break;case"TopCenter":Phaser.Display.Align.In.TopCenter(e,this.hitArea,s,i);break;case"TopRight":Phaser.Display.Align.In.TopRight(e,this.hitArea,s,i);break;case"LeftCenter":Phaser.Display.Align.In.LeftCenter(e,this.hitArea,s,i);break;case"Center":Phaser.Display.Align.In.Center(e,this.hitArea,s,i);break;case"RightCenter":Phaser.Display.Align.In.RightCenter(e,this.hitArea,s,i);break;case"BottomLeft":Phaser.Display.Align.In.BottomLeft(e,this.hitArea,s,i);break;case"BottomCenter":Phaser.Display.Align.In.BottomCenter(e,this.hitArea,s,i);break;case"BottomRight":Phaser.Display.Align.In.BottomRight(e,this.hitArea,s,i);break;default:Phaser.Display.Align.In.Center(e,this)}return super.add(e),this}setSize(e,t){return this.hitArea.setSize(e,t),super.setSize(e,t),this}getHitArea(){return this.hitArea}}const B=w;class V extends B{constructor(e,t,s,i,n){super(e,t,s),this.isHovered=!1,this.image=new Phaser.GameObjects.Image(e,0,0,i,n),this.add(this.image),this.setSize(this.image.width,this.image.height)}clearTint(){return this.image.clearTint(),this}setSize(e,t){return this.image.setSize(e,t),super.setSize(e,t),this}setTint(e,t,s,i){this.image.setTint(e,t,s,i);for(let n=0;n<this.list.length;n++){let a=this.list[n];"setTint"in a&&"function"==typeof a.setTint&&a.setTint(e,t,s,i)}return this}setTintFill(e,t,s,i){return this.image.setTintFill(e,t,s,i),this}setTexture(e,t){return this.image.setTexture(e,t),this}setInteractive(e,t,s){return this.hitArea.setInteractive(e,t,s),this.hitArea.on("pointerover",this.enterHoverState,this),this.hitArea.on("pointerout",this.enterRestState,this),super.setInteractive(),this}disableInteractive(){return this.hitArea.off("pointerover",this.enterHoverState,this),this.hitArea.off("pointerout",this.enterRestState,this),this.hitArea.disableInteractive(),super.disableInteractive(),this}enterHoverState(){this.isHovered=!0,this.emit(V.BUTTON_HOVER_EVENT)}enterRestState(){this.isHovered&&(this.isHovered=!1,this.emit(V.BUTTON_REST_EVENT))}}V.BUTTON_HOVER_EVENT="hover",V.BUTTON_REST_EVENT="rest";const C=V;class x extends C{constructor(e,t,s,i,n){super(e,t,s,i,n),this.isClicked=!1,this.setInteractive()}setInteractive(e,t,s){return this.hitArea.setInteractive({useHandCursor:!0}),this.hitArea.on("pointerdown",this.enterPressDownState,this),this.hitArea.on("pointerup",this.enterPressUpState,this),this.hitArea.on("pointerover",this.enterHoverState,this),this.hitArea.on("pointerout",this.enterRestState,this),super.setInteractive(),this}disableInteractive(){return this.hitArea.off("pointerdown",this.enterPressDownState,this),this.hitArea.off("pointerup",this.enterPressUpState,this),this.hitArea.off("pointerover",this.enterHoverState,this),this.hitArea.off("pointerout",this.enterRestState,this),this.hitArea.disableInteractive(),super.disableInteractive(),this}enterRestState(){this.isHovered&&(this.isHovered=!1,this.isClicked&&(this.isClicked=!1),this.emit(C.BUTTON_REST_EVENT))}enterPressDownState(){this.isClicked=!0,this.emit(x.BUTTON_DOWN_EVENT)}enterPressUpState(){this.isClicked&&(this.isClicked=!1,this.emit(x.BUTTON_UP_EVENT))}}x.BUTTON_DOWN_EVENT="buttondown",x.BUTTON_UP_EVENT="buttonup",x.BUTTON_HOVER_EVENT="hover",x.BUTTON_REST_EVENT="rest";const I=x;class P extends C{constructor(e,t,s,i){super(e,0,0,"black"),this.isEnabled=!1,this.setDisplaySize(e.scale.width,e.scale.height),this.setSize(e.scale.width,e.scale.height),this.setPosition(e.scale.width/2,e.scale.height/2),this.setAlpha(t),this.from=t,this.to=s,this.duration=i,this.setInteractive()}setInteractive(){return O.applyAlphaTweens(this,[P.BLACK_UI_IMAGE_ENABLE_EVENT],[P.BLACK_UI_IMAGE_DISABLE_EVENT],this.from,this.to,this.duration),this}disableInteractive(){return this.off(P.BLACK_UI_IMAGE_ENABLE_EVENT),this.off(P.BLACK_UI_IMAGE_DISABLE_EVENT),this}}P.BLACK_UI_IMAGE_ENABLE_EVENT="enable",P.BLACK_UI_IMAGE_DISABLE_EVENT="disable";const A=P;class v extends C{constructor(e,t,s,i,n,a,o,h=1,r=!1,l){super(e,t,s,i,l),this.start=n,this.end=a,this.currentValue=0,this.knob=o,this.mustKnobDrag=r,this.dragSpeed=h,this.add(this.knob),this.bringToTop(this.knob),this.setValue(0),this.setInteractive()}getValue(){return this.currentValue}setValue(e){const t=Phaser.Math.Clamp(e,0,1),s=this.start.clone().lerp(this.end,t);this.knob.setPosition(s.x,s.y),this.updateValue(s)}updateValue(e){const t=this.start.distance(this.end),s=this.start.distance(e);if(0===t)return;const i=s/t;i!==this.currentValue&&(this.emit(v.VALUE_CHANGED_EVENT,this.currentValue,i),this.currentValue=i)}setInteractive(e,t,s){return this.knob?(this.knob.setInteractive({useHandCursor:!0,draggable:!0}),this.knob.getHitArea().on("drag",this.dragKnob,this),this.knob.getHitArea().on("dragstart",this.startDragKnob,this),this.knob.getHitArea().on("dragend",this.endDragKnob,this)):console.error("Knob is not initialized."),this.hitArea.on("pointerdown",this.enterPressDownState,this),this.hitArea.on("pointerup",this.enterPressUpState,this),this.hitArea.on("pointerover",this.enterHoverState,this),this.hitArea.on("pointerout",this.enterRestState,this),this}disableInteractive(){return this.scene.input.setDraggable(this.knob,!1),this.knob.getHitArea().off("drag",this.dragKnob,this),this.knob.getHitArea().off("dragstart",this.startDragKnob,this),this.knob.getHitArea().off("dragend",this.endDragKnob,this),this.hitArea.off("pointerdown",this.enterPressDownState,this),this.hitArea.off("pointerup",this.enterPressUpState,this),this.hitArea.off("pointerover",this.enterHoverState,this),this.hitArea.off("pointerout",this.enterRestState,this),this.hitArea.disableInteractive(),super.disableInteractive(),this}startDragKnob(e,t,s){this.dragPosition=new Phaser.Math.Vector2(this.knob.x,this.knob.y)}endDragKnob(e,t,s){this.dragPosition=new Phaser.Math.Vector2(this.knob.x,this.knob.y)}dragKnob(e,t,s){let i=new Phaser.Math.Vector2(Phaser.Math.Clamp(t*this.dragSpeed+this.dragPosition.x,this.start.x,this.end.x),Phaser.Math.Clamp((s*this.dragSpeed+this.dragPosition.y)*this.dragSpeed,this.start.y,this.end.y));this.knob.setPosition(i.x,i.y),this.updateValue(i)}enterRestState(){this.isHovered&&(this.isHovered=!1,this.isClicked&&(this.isClicked=!1),this.emit(v.BUTTON_REST_EVENT))}enterPressDownState(){this.isClicked=!0,this.emit(v.BUTTON_DOWN_EVENT)}enterPressUpState(){this.isClicked&&(this.isClicked=!1,this.emit(v.BUTTON_UP_EVENT))}}v.BUTTON_DOWN_EVENT="buttondown",v.BUTTON_UP_EVENT="buttonup",v.VALUE_CHANGED_EVENT="valuechanged";const D=v,R=class extends B{constructor(e,t,s,i,n,a){super(e,t,s),e.add.existing(this),this.onTexture=i,this.offTexture=n,this.isMusicOrSound=a;let o=this.scene.data.get(h.AUDIO_CONTROLLER_KEY);this.audioController=o;const r=new D(this.scene,0,0,"slim-slider-frame",new Phaser.Math.Vector2(-600,0),new Phaser.Math.Vector2(600,0),new C(this.scene,0,0,"slim-slider-red-button"),3);r.setScale(.7),this.add(r,"Center",100,0),this.slider=r;const l=new C(this.scene,0,0,"slim-slider-background");r.add(l,"Center"),r.sendToBack(l),r.on(D.VALUE_CHANGED_EVENT,((e,t)=>{console.log("Music volume changed to",t),this.isMusicOrSound?o.adjustMusicVolume(t):o.adjustSoundVolume(t),this.musicButton.setTexture(0===t?this.offTexture:this.onTexture)}));const c=new I(this.scene,0,0,i);c.setScale(.7),this.add(c,"Center",-550,0),this.musicButton=c,c.on(I.BUTTON_UP_EVENT,(()=>{if(this.isMusicOrSound){let e=o.getMusicVolume();o.adjustMusicVolume(0===e?1:0),c.setTexture(0===e?this.offTexture:this.onTexture),this.slider.setValue(o.getMusicVolume())}else{let e=o.getSoundVolume();o.adjustSoundVolume(0===e?1:0),c.setTexture(0===e?this.offTexture:this.onTexture),this.slider.setValue(o.getSoundVolume())}})),O.applyTintTweens(c,I.BUTTON_DOWN_EVENT,[I.BUTTON_UP_EVENT,I.BUTTON_REST_EVENT],16777215,12105912,200),O.applyScaleTweens(c,I.BUTTON_HOVER_EVENT,I.BUTTON_REST_EVENT,c.scaleX,c.scaleY,1.1,100),this.isMusicOrSound?(c.setTexture(0===o.getMusicVolume()?this.offTexture:this.onTexture),this.slider.setValue(o.getMusicVolume())):(c.setTexture(0===o.getSoundVolume()?this.offTexture:this.onTexture),this.slider.setValue(o.getSoundVolume()))}};class k extends i.GameObjects.Graphics{constructor(e,t,s){super(e),this.hasEndGame=!1,e.add.existing(this),this.audioController=this.scene.data.get(h.AUDIO_CONTROLLER_KEY),this.createPlayUi(),this.createPauseUi(),this.createOverlayUi(),this.createWinUi(),this.createLoseUi(),this.createBlackImages(e),this.initializeSceneLoad()}createBlackImages(e){this.blackBackground=new A(e,0,.4,200),this.blackBackground.setDepth(999),this.blackSceneTransition=new A(e,1,0,700),this.blackSceneTransition.setDepth(2e3),this.pauseController=new b(e,[])}createPlayUi(){this.playUi=new B(this.scene,0,0),this.playUi.setSize(this.scene.scale.width,this.scene.scale.height),this.playUi.setPosition(this.scene.scale.width/2,this.scene.scale.height/2),this.playUi.setDepth(1e3);const e=new I(this.scene,100,100,"icon-small-white-outline-pause");e.setScale(.6),e.on(I.BUTTON_UP_EVENT,this.showPauseUi,this),O.applyTintTweens(e,I.BUTTON_DOWN_EVENT,[I.BUTTON_UP_EVENT,I.BUTTON_REST_EVENT],16777215,12105912,200),O.applyScaleTweens(e,I.BUTTON_HOVER_EVENT,I.BUTTON_REST_EVENT,e.scaleX,e.scaleY,1.1,100),e.on(I.BUTTON_DOWN_EVENT,(()=>{this.audioController.playSound("button-down")})),this.playUi.add(e,"TopLeft",-30,-30),console.log("playUi",this.playUi,this.playUi.displayWidth,this.playUi.displayHeight,this.playUi.width,this.playUi.height,this.playUi.scaleX,this.playUi.scaleY,this.playUi.x,this.playUi.y),console.log("pauseButton",e,e.displayWidth,e.displayHeight,e.width,e.height,e.scaleX,e.scaleY,e.x,e.y)}createPauseUi(){this.pauseUi=new B(this.scene,0,0),this.pauseUi.setSize(this.scene.scale.width,this.scene.scale.height),this.pauseUi.setPosition(this.scene.scale.width/2,3*this.scene.scale.height/2),this.pauseUi.setDepth(1e3);const e=new C(this.scene,0,0,"box-white-outline-rounded");e.setScale(.5),this.pauseUi.add(e,"Center");const t=this.scene.add.text(0,0,"PAUSED",{fontFamily:"bold Arial",fontSize:120,color:"#ffffff"});e.add(t,"TopCenter",0,-200);const s=new I(this.scene,0,0,"icon-button-large-red-square");s.setScale(.8),e.add(s,"BottomLeft",-150,-100);const i=this.scene.add.image(0,0,"icon-small-white-outline-home");i.setScale(1.2),s.add(i,"Center"),s.on(I.BUTTON_UP_EVENT,(()=>{this.scene.time.delayedCall(700,(()=>this.scene.scene.start("MenuScene"))),this.blackSceneTransition.emit(A.BLACK_UI_IMAGE_DISABLE_EVENT)})),O.applyTintTweens(s,I.BUTTON_DOWN_EVENT,[I.BUTTON_UP_EVENT,I.BUTTON_REST_EVENT],16777215,12105912,200),O.applyScaleTweens(s,I.BUTTON_HOVER_EVENT,I.BUTTON_REST_EVENT,s.scaleX,s.scaleY,1.1,100),s.on(I.BUTTON_DOWN_EVENT,(()=>{this.audioController.playSound("button-down")}));const n=new I(this.scene,0,0,"icon-button-large-blue-square");n.setScale(.8),e.add(n,"BottomCenter",0,-100);const a=this.scene.add.image(0,0,"icon-small-white-outline-return");a.setScale(1.2),n.add(a,"Center"),n.on(I.BUTTON_UP_EVENT,(()=>{this.scene.time.delayedCall(700,(()=>this.scene.scene.start("GameScene"))),this.blackSceneTransition.emit(A.BLACK_UI_IMAGE_DISABLE_EVENT)})),O.applyTintTweens(n,I.BUTTON_DOWN_EVENT,[I.BUTTON_UP_EVENT,I.BUTTON_REST_EVENT],16777215,12105912,200),O.applyScaleTweens(n,I.BUTTON_HOVER_EVENT,I.BUTTON_REST_EVENT,n.scaleX,n.scaleY,1.1,100),n.on(I.BUTTON_DOWN_EVENT,(()=>{this.audioController.playSound("button-down")}));const o=new I(this.scene,0,0,"icon-button-large-green-square");o.setScale(.8),e.add(o,"BottomRight",-150,-100);const h=this.scene.add.image(0,0,"icon-small-white-outline-arrow");h.setScale(1.2),o.add(h,"Center"),o.on(I.BUTTON_UP_EVENT,this.hidePauseUi,this),O.applyTintTweens(o,I.BUTTON_DOWN_EVENT,[I.BUTTON_UP_EVENT,I.BUTTON_REST_EVENT],16777215,12105912,200),O.applyScaleTweens(o,I.BUTTON_HOVER_EVENT,I.BUTTON_REST_EVENT,o.scaleX,o.scaleY,1.1,100),o.on(I.BUTTON_DOWN_EVENT,(()=>{this.audioController.playSound("button-down")}));let r=new R(this.scene,0,0,"icon-large-music-blank","icon-large-music-off-blank",!0);e.add(r,"BottomCenter",0,-700);let l=new R(this.scene,0,0,"icon-large-audio-blank","icon-large-audio-off-blank",!1);e.add(l,"BottomCenter",0,-1e3),O.applyPositionTweens(this.pauseUi,k.PAUSE_UI_SHOW_EVENT,k.PAUSE_UI_HIDE_EVENT,this.scene.scale.width/2,3*this.scene.scale.height/2,0,-this.scene.scale.height,300)}createWinUi(){this.winUi=new B(this.scene,0,0),this.winUi.setSize(this.scene.scale.width,this.scene.scale.height),this.winUi.setPosition(this.scene.scale.width/2,3*this.scene.scale.height/2),this.winUi.setDepth(1e3);const e=new C(this.scene,0,0,"box-white-outline-rounded");e.setScale(.5),this.winUi.add(e,"Center");const t=this.scene.add.text(0,0,"VICTORY",{fontFamily:"bold Arial",fontSize:200,color:"#dbb337"});e.add(t,"TopCenter",0,-200);let s=this.scene.data.get(m.SCORE_COUNTER_KEY);const i=this.scene.add.text(0,0,"Score: 0",{fontFamily:"bold Arial",fontSize:140,color:"#ffffff"});e.add(i,"Center",0,-200),s.on(m.SCORE_CHANGE_EVENT,((e,t)=>{i.setText(`Score: ${t}`)}));const n=this.scene.add.text(0,0,`High Score: ${s.loadHighScore()}`,{fontFamily:"bold Arial",fontSize:140,color:"#ffffff"});e.add(n,"Center",0,100),s.on(m.HIGH_SCORE_CHANGE_EVENT,(e=>{n.setText(`High Score: ${e}`)}));const a=new I(this.scene,0,0,"icon-button-large-red-square");a.setScale(.8),e.add(a,"BottomCenter",-350,-100);const o=this.scene.add.image(0,0,"icon-small-white-outline-home");o.setScale(1.2),a.add(o,"Center"),a.on(I.BUTTON_UP_EVENT,(()=>{this.scene.time.delayedCall(700,(()=>this.scene.scene.start("MenuScene"))),this.blackSceneTransition.emit(A.BLACK_UI_IMAGE_DISABLE_EVENT)})),O.applyTintTweens(a,I.BUTTON_DOWN_EVENT,[I.BUTTON_UP_EVENT,I.BUTTON_REST_EVENT],16777215,12105912,200),O.applyScaleTweens(a,I.BUTTON_HOVER_EVENT,I.BUTTON_REST_EVENT,a.scaleX,a.scaleY,1.1,100),a.on(I.BUTTON_DOWN_EVENT,(()=>{this.audioController.playSound("button-down")}));const h=new I(this.scene,0,0,"icon-button-large-blue-square");h.setScale(.8),e.add(h,"BottomCenter",350,-100);const r=this.scene.add.image(0,0,"icon-small-white-outline-return");r.setScale(1.2),h.add(r,"Center"),h.on(I.BUTTON_UP_EVENT,(()=>{this.scene.time.delayedCall(700,(()=>this.scene.scene.start("GameScene"))),this.blackSceneTransition.emit(A.BLACK_UI_IMAGE_DISABLE_EVENT)})),O.applyTintTweens(h,I.BUTTON_DOWN_EVENT,[I.BUTTON_UP_EVENT,I.BUTTON_REST_EVENT],16777215,12105912,200),O.applyScaleTweens(h,I.BUTTON_HOVER_EVENT,I.BUTTON_REST_EVENT,h.scaleX,h.scaleY,1.1,100),h.on(I.BUTTON_DOWN_EVENT,(()=>{this.audioController.playSound("button-down")})),O.applyPositionTweens(this.winUi,k.WIN_UI_SHOW_EVENT,[],this.scene.scale.width/2,3*this.scene.scale.height/2,0,-this.scene.scale.height,300)}createLoseUi(){this.loseUi=new B(this.scene,0,0),this.loseUi.setSize(this.scene.scale.width,this.scene.scale.height),this.loseUi.setPosition(this.scene.scale.width/2,3*this.scene.scale.height/2),this.loseUi.setDepth(1e3);const e=new C(this.scene,0,0,"box-white-outline-rounded");e.setScale(.5),this.loseUi.add(e,"Center");const t=this.scene.add.text(0,0,"DEFEATED",{fontFamily:"bold Arial",fontSize:200,color:"#612221"});e.add(t,"TopCenter",0,-200);let s=this.scene.data.get(m.SCORE_COUNTER_KEY);const i=this.scene.add.text(0,0,"Score: 0",{fontFamily:"bold Arial",fontSize:140,color:"#ffffff"});e.add(i,"Center",0,-200),s.on(m.SCORE_CHANGE_EVENT,((e,t)=>{i.setText(`Score: ${t}`)}));const n=this.scene.add.text(0,0,`High Score: ${s.loadHighScore()}`,{fontFamily:"bold Arial",fontSize:140,color:"#ffffff"});e.add(n,"Center",0,100),s.on(m.HIGH_SCORE_CHANGE_EVENT,(e=>{n.setText(`High Score: ${e}`)}));const a=new I(this.scene,0,0,"icon-button-large-red-square");a.setScale(.8),e.add(a,"BottomCenter",-350,-100);const o=this.scene.add.image(0,0,"icon-small-white-outline-home");o.setScale(1.2),a.add(o,"Center"),a.on(I.BUTTON_UP_EVENT,(()=>{this.scene.time.delayedCall(700,(()=>this.scene.scene.start("MenuScene"))),this.blackSceneTransition.emit(A.BLACK_UI_IMAGE_DISABLE_EVENT)})),O.applyTintTweens(a,I.BUTTON_DOWN_EVENT,[I.BUTTON_UP_EVENT,I.BUTTON_REST_EVENT],16777215,12105912,200),O.applyScaleTweens(a,I.BUTTON_HOVER_EVENT,I.BUTTON_REST_EVENT,a.scaleX,a.scaleY,1.1,100),a.on(I.BUTTON_DOWN_EVENT,(()=>{this.audioController.playSound("button-down")}));const h=new I(this.scene,0,0,"icon-button-large-blue-square");h.setScale(.8),e.add(h,"BottomCenter",350,-100);const r=this.scene.add.image(0,0,"icon-small-white-outline-return");r.setScale(1.2),h.add(r,"Center"),h.on(I.BUTTON_UP_EVENT,(()=>{this.scene.time.delayedCall(700,(()=>this.scene.scene.start("GameScene"))),this.blackSceneTransition.emit(A.BLACK_UI_IMAGE_DISABLE_EVENT)})),O.applyTintTweens(h,I.BUTTON_DOWN_EVENT,[I.BUTTON_UP_EVENT,I.BUTTON_REST_EVENT],16777215,12105912,200),O.applyScaleTweens(h,I.BUTTON_HOVER_EVENT,I.BUTTON_REST_EVENT,h.scaleX,h.scaleY,1.1,100),h.on(I.BUTTON_DOWN_EVENT,(()=>{this.audioController.playSound("button-down")})),this.scene.data.get(d.ENEMY_COUNTER_KEY).on(d.PLAYER_DIED_EVENT,(()=>{this.showLoseUi()})),O.applyPositionTweens(this.loseUi,k.LOSE_UI_SHOW_EVENT,[],this.scene.scale.width/2,3*this.scene.scale.height/2,0,-this.scene.scale.height,300)}createOverlayUi(){let e=new B(this.scene,0,0);e.setSize(this.scene.scale.width,this.scene.scale.height),e.setPosition(this.scene.scale.width/2,this.scene.scale.height/2),e.setDepth(1100),this.overlayUi=e;const t=new C(this.scene,0,0,"skull");t.setScale(.25),e.add(t,"TopCenter",-50,80);const s=this.scene.add.text(0,0,"0/7",{fontFamily:"bold Arial",fontSize:60,color:"#ffffff"});e.add(s,"TopCenter",50,-40),this.scene.data.get(d.ENEMY_COUNTER_KEY).on(d.ENEMY_DESTROYED_EVENT,((e,t)=>{s.setText(`${t-e.length}/${t}`),this.checkWin(e)}));let i=this.scene.data.get(m.SCORE_COUNTER_KEY);const n=this.scene.add.text(0,0,"Score: 0",{fontFamily:"bold Arial",fontSize:60,color:"#ffffff"});e.add(n,"TopRight",130,-40),n.setOrigin(1,0),i.on(m.SCORE_CHANGE_EVENT,((e,t)=>{n.setText(`Score: ${t}`)}))}initializeSceneLoad(){this.playUi.setVisible(!0),this.blackSceneTransition.emit(A.BLACK_UI_IMAGE_ENABLE_EVENT)}checkWin(e){0===e.length&&(this.scene.data.get(m.SCORE_COUNTER_KEY).saveHighScore(),this.showWinUi())}showPauseUi(){this.playUi.setVisible(!1),this.pauseUi.emit(k.PAUSE_UI_SHOW_EVENT),this.pauseController.setObjectFromScene(this.scene),this.pauseController.pause(),this.blackBackground.emit(A.BLACK_UI_IMAGE_ENABLE_EVENT)}hidePauseUi(){this.playUi.setVisible(!0),this.pauseUi.emit(k.PAUSE_UI_HIDE_EVENT),this.pauseController.resume(),this.blackBackground.emit(A.BLACK_UI_IMAGE_DISABLE_EVENT)}showLoseUi(){if(this.hasEndGame)return;this.hasEndGame=!0;let e=this.scene.add.text(this.scene.scale.width/2,this.scene.scale.height/2,"YOU DIED",{fontFamily:'"Times New Roman", Times, serif',fontSize:"74px",color:"#612221",fontStyle:"bold"}).setOrigin(.5).setAlpha(0).setDepth(1e3).setScrollFactor(0),t=this.scene.add.image(this.scene.scale.width/2,this.scene.scale.height/2,"black");t.setDisplaySize(this.scene.scale.width,300),t.setDepth(999),t.setAlpha(0),t.setScrollFactor(0),this.blackBackground.emit(A.BLACK_UI_IMAGE_ENABLE_EVENT),this.scene.tweens.chain({tweens:[{targets:[e,t],alpha:{from:0,to:1},ease:Phaser.Math.Easing.Back.Out,duration:200,hold:2e3},{targets:[e,t],alpha:{from:1,to:0},ease:Phaser.Math.Easing.Linear,duration:1e3}],onComplete:()=>{this.overlayUi.setVisible(!1),this.pauseController.setObjectFromScene(this.scene),this.pauseController.pause(),this.loseUi.emit(k.LOSE_UI_SHOW_EVENT),e.destroy(),t.destroy()}}),this.playUi.setVisible(!1)}showWinUi(){if(this.hasEndGame)return;this.hasEndGame=!0;let e=new C(this.scene,0,0,"winner-winner-chicken-dinner");e.setScale(0),e.setDepth(1e3),this.overlayUi.add(e,"Center"),this.blackBackground.emit(A.BLACK_UI_IMAGE_ENABLE_EVENT),this.scene.tweens.chain({tweens:[{targets:e,scale:{from:0,to:1.5},ease:Phaser.Math.Easing.Back.Out,duration:1e3},{delay:1e3,targets:e,scale:{from:1.5,to:0},alpha:{from:1,to:0},ease:Phaser.Math.Easing.Cubic.In,duration:500}],onComplete:()=>{this.overlayUi.setVisible(!1),this.pauseController.setObjectFromScene(this.scene),this.pauseController.pause(),this.winUi.emit(k.WIN_UI_SHOW_EVENT),e.destroy()}}),this.playUi.setVisible(!1)}}k.PAUSE_UI_SHOW_EVENT="pauseUiShow",k.PAUSE_UI_HIDE_EVENT="pauseUiHide",k.WIN_UI_SHOW_EVENT="winUiShow",k.LOSE_UI_SHOW_EVENT="loseUiShow";const H=k;class L extends Phaser.Scene{constructor(){super({key:"GameScene"})}init(){}create(){let e=new h(this),t=new m,s=new d([]);this.data.set(h.AUDIO_CONTROLLER_KEY,e),this.data.set(m.SCORE_COUNTER_KEY,t),this.data.set(d.ENEMY_COUNTER_KEY,s),this.cameras.main.setBackgroundColor("#80be1f"),this.map=this.make.tilemap({key:"levelMap"}),this.tileset=this.map.addTilesetImage("tiles"),this.layer=this.map.createLayer("tileLayer",this.tileset,0,0),this.layer.setCollisionByProperty({collide:!0}),this.obstacles=this.add.group({runChildUpdate:!0}),this.enemies=this.add.group({}),this.convertObjects(),this.physics.add.collider(this.player,this.layer),this.physics.add.collider(this.player,this.obstacles),this.physics.add.overlap(this.player.getBullets(),this.layer,this.bulletHitLayer,void 0,this),this.physics.add.overlap(this.player.getBullets(),this.obstacles,this.bulletHitObstacles,void 0,this),this.enemies.getChildren().forEach((e=>{let t=e;s.addEnemy(t),this.physics.add.overlap(this.player.getBullets(),e,this.playerBulletHitEnemy,void 0,this),this.physics.add.overlap(t.getBullets(),this.player,this.enemyBulletHitPlayer,void 0),this.physics.add.overlap(t.getBullets(),this.obstacles,this.bulletHitObstacles,void 0),this.physics.add.overlap(t.getBullets(),this.layer,this.bulletHitLayer,void 0)}),this),this.cameras.main.startFollow(this.player),new H(this,0,0),e.playMusic("age-of-war-theme-song")}update(){this.player.update(),this.enemies.getChildren().forEach((e=>{let t=e;if(t.update(),this.player.active&&t.active){var s=Phaser.Math.Angle.Between(t.body.x,t.body.y,this.player.body.x,this.player.body.y);t.getBarrel().angle=(s+Math.PI/2)*Phaser.Math.RAD_TO_DEG}}),this)}convertObjects(){const e=this.map.getObjectLayer("objects");(e?e.objects:[]).forEach((e=>{if("player"===e.type)this.player=new p({scene:this,x:e.x,y:e.y,texture:"tankBlue"});else if("enemy"===e.type){let t=new S({scene:this,x:e.x,y:e.y,texture:"tankRed"});this.enemies.add(t)}else{let t=new U({scene:this,x:e.x,y:e.y-40,texture:e.type});this.obstacles.add(t)}}))}bulletHitLayer(e,t){e instanceof l&&t instanceof Phaser.Tilemaps.Tile&&t.properties.collide&&e.explode()}bulletHitObstacles(e,t){e instanceof l&&e.explode()}enemyBulletHitPlayer(e,t){t instanceof p&&e instanceof l&&(e.explode(),t.updateHealth())}playerBulletHitEnemy(e,t){t instanceof S&&e instanceof l&&(e.explode(),t.updateHealth())}}const M=L;class G extends i.GameObjects.Graphics{constructor(e){super(e),e.add.existing(this),this.audioController=this.scene.data.get(h.AUDIO_CONTROLLER_KEY),this.createPlayUi(),this.createSettingUi(),this.createBlackBackground(e)}createPlayUi(){this.menuUi=new B(this.scene,0,0),this.menuUi.setSize(this.scene.scale.width,this.scene.scale.height),this.menuUi.setPosition(this.scene.scale.width/2,this.scene.scale.height/2),this.menuUi.setDepth(1e3);const e=new C(this.scene,0,0,"splash-art");e.setDisplaySize(this.scene.scale.width,this.scene.scale.height),this.menuUi.add(e,"Center");const t=new I(this.scene,0,0,"button-text-small-green-round");t.setScale(.8),this.menuUi.add(t,"BottomLeft",-90,-400);const s=this.scene.add.text(0,0,"PLAY",{fontSize:"67px",color:"#ffffff",fontStyle:"bold",fontFamily:"Arial"});t.add(s,"Center");const i=new I(this.scene,0,0,"button-text-small-blue-round");i.setScale(.8),this.menuUi.add(i,"BottomLeft",-90,-100);const n=this.scene.add.text(0,0,"SETTINGS",{fontSize:"67px",color:"#ffffff",fontStyle:"bold",fontFamily:"Arial"});i.add(n,"Center"),this.playButton=t,this.settingsButton=i,t.on(I.BUTTON_UP_EVENT,(()=>{this.scene.time.delayedCall(400,(()=>this.scene.scene.start("GameScene"))),this.blackSceneTransition.emit(A.BLACK_UI_IMAGE_DISABLE_EVENT)})),O.applyTintTweens(t,I.BUTTON_DOWN_EVENT,[I.BUTTON_UP_EVENT,I.BUTTON_REST_EVENT],16777215,12105912,200),O.applyScaleTweens(t,I.BUTTON_HOVER_EVENT,I.BUTTON_REST_EVENT,t.scaleX,t.scaleY,1.1,100),t.on(I.BUTTON_UP_EVENT,(()=>{this.audioController.playSound("button-down")})),i.on(I.BUTTON_UP_EVENT,this.showSettingsUi,this),O.applyTintTweens(i,I.BUTTON_DOWN_EVENT,[I.BUTTON_UP_EVENT,I.BUTTON_REST_EVENT],16777215,12105912,200),O.applyScaleTweens(i,I.BUTTON_HOVER_EVENT,I.BUTTON_REST_EVENT,i.scaleX,i.scaleY,1.1,100),i.on(I.BUTTON_UP_EVENT,(()=>{this.audioController.playSound("button-down")}))}createSettingUi(){this.settingUi=new B(this.scene,0,0),this.settingUi.setSize(this.scene.scale.width,this.scene.scale.height),this.settingUi.setPosition(this.scene.scale.width/2,3*this.scene.scale.height/2),this.settingUi.setDepth(1e3);const e=new C(this.scene,0,0,"box-white-outline-rounded");e.setScale(.5),this.settingUi.add(e,"Center");const t=this.scene.add.text(0,0,"SETTINGS",{fontFamily:"bold Arial",fontSize:120,color:"#ffffff"});e.add(t,"TopCenter",0,-200);const s=new I(this.scene,0,0,"icon-button-large-red-square");s.setScale(.8),e.add(s,"BottomCenter",0,-100);const i=this.scene.add.image(0,0,"icon-small-white-outline-x");i.setScale(1.2),s.add(i,"Center"),s.on(I.BUTTON_UP_EVENT,this.hideSettingUi,this),O.applyTintTweens(s,I.BUTTON_DOWN_EVENT,[I.BUTTON_UP_EVENT,I.BUTTON_REST_EVENT],16777215,12105912,200),O.applyScaleTweens(s,I.BUTTON_HOVER_EVENT,I.BUTTON_REST_EVENT,s.scaleX,s.scaleY,1.1,100),s.on(I.BUTTON_DOWN_EVENT,(()=>{this.audioController.playSound("button-down")}));let n=new R(this.scene,0,0,"icon-large-music-blank","icon-large-music-off-blank",!0);e.add(n,"BottomCenter",0,-700);let a=new R(this.scene,0,0,"icon-large-audio-blank","icon-large-audio-off-blank",!1);e.add(a,"BottomCenter",0,-1e3),O.applyPositionTweens(this.settingUi,G.SETTINGS_UI_SHOW_EVENT,G.SETTINGS_UI_HIDE_EVENT,this.scene.scale.width/2,3*this.scene.scale.height/2,0,-this.scene.scale.height,300)}showSettingsUi(){this.settingUi.emit(G.SETTINGS_UI_SHOW_EVENT),this.playButton.off(I.BUTTON_UP_EVENT),this.playButton.off(I.BUTTON_HOVER_EVENT),this.playButton.off(I.BUTTON_DOWN_EVENT),this.playButton.setInteractive(!1),this.settingsButton.off(I.BUTTON_UP_EVENT),this.settingsButton.off(I.BUTTON_HOVER_EVENT),this.settingsButton.off(I.BUTTON_DOWN_EVENT),this.settingsButton.setInteractive(!1)}hideSettingUi(){this.menuUi.setInteractive(),this.settingUi.emit(G.SETTINGS_UI_HIDE_EVENT),this.playButton.on(I.BUTTON_UP_EVENT,(()=>{this.scene.time.delayedCall(400,(()=>this.scene.scene.start("GameScene"))),this.blackSceneTransition.emit(A.BLACK_UI_IMAGE_DISABLE_EVENT)})),O.applyTintTweens(this.playButton,I.BUTTON_DOWN_EVENT,[I.BUTTON_UP_EVENT,I.BUTTON_REST_EVENT],16777215,12105912,200),O.applyScaleTweens(this.playButton,I.BUTTON_HOVER_EVENT,I.BUTTON_REST_EVENT,this.playButton.scaleX,this.playButton.scaleY,1.1,100),this.playButton.on(I.BUTTON_UP_EVENT,(()=>{this.audioController.playSound("button-down")})),this.settingsButton.on(I.BUTTON_UP_EVENT,this.showSettingsUi,this),O.applyTintTweens(this.settingsButton,I.BUTTON_DOWN_EVENT,[I.BUTTON_UP_EVENT,I.BUTTON_REST_EVENT],16777215,12105912,200),O.applyScaleTweens(this.settingsButton,I.BUTTON_HOVER_EVENT,I.BUTTON_REST_EVENT,this.settingsButton.scaleX,this.settingsButton.scaleY,1.1,100),this.settingsButton.on(I.BUTTON_UP_EVENT,(()=>{this.audioController.playSound("button-down")}))}createBlackBackground(e){this.blackSceneTransition=new A(e,1,0,400),this.blackSceneTransition.setDepth(2e3),this.blackSceneTransition.emit(A.BLACK_UI_IMAGE_ENABLE_EVENT)}}G.SETTINGS_UI_SHOW_EVENT="settingsUiShow",G.SETTINGS_UI_HIDE_EVENT="settingsUiHide";const K=G;class W extends Phaser.Scene{constructor(){super({key:"MenuScene"})}init(){}create(){let e=new h(this);new K(this),e.playMusic("age-of-war-theme-song")}}const Y=W,z={title:"Tank",url:"https://github.com/digitsensitive/phaser3-typescript",version:"0.0.1",zoom:.6,scale:{mode:Phaser.Scale.FIT,width:1600,height:1200},type:Phaser.AUTO,autoCenter:Phaser.Scale.CENTER_BOTH,parent:"game",scene:[a,Y,M],input:{keyboard:!0},physics:{default:"arcade",arcade:{gravity:{x:0,y:0}}},backgroundColor:"#000000",render:{antialias:!0},antialias:!0,pixelArt:!1};class j extends Phaser.Game{constructor(e){super(e)}}window.addEventListener("load",(()=>{new j(z)}))}},s={};function i(e){var n=s[e];if(void 0!==n)return n.exports;var a=s[e]={exports:{}};return t[e].call(a.exports,a,a.exports,i),a.exports}i.m=t,e=[],i.O=(t,s,n,a)=>{if(!s){var o=1/0;for(c=0;c<e.length;c++){for(var[s,n,a]=e[c],h=!0,r=0;r<s.length;r++)(!1&a||o>=a)&&Object.keys(i.O).every((e=>i.O[e](s[r])))?s.splice(r--,1):(h=!1,a<o&&(o=a));if(h){e.splice(c--,1);var l=n();void 0!==l&&(t=l)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[s,n,a]},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={792:0};i.O.j=t=>0===e[t];var t=(t,s)=>{var n,a,[o,h,r]=s,l=0;if(o.some((t=>0!==e[t]))){for(n in h)i.o(h,n)&&(i.m[n]=h[n]);if(r)var c=r(i)}for(t&&t(s);l<o.length;l++)a=o[l],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(c)},s=self.webpackChunktype_project_template=self.webpackChunktype_project_template||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var n=i.O(void 0,[96],(()=>i(248)));n=i.O(n)})();